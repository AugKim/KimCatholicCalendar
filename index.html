<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·ªãch Ph·ª•ng V·ª• C√¥ng Gi√°o</title>
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2563eb">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="L·ªãch Ph·ª•ng V·ª•">
    <meta name="description" content="L·ªãch Ph·ª•ng V·ª• C√¥ng Gi√°o Vi·ªát Nam - Tra c·ª©u b√†i ƒë·ªçc, l·ªÖ c√°c th√°nh, l·ªãch √¢m">
    <!-- Preconnect to CDN -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <div class="container mx-auto p-4 max-w-[95%] app-shell">
        <header class="app-header text-center mb-8 p-8 rounded-2xl sticky top-0 z-30 ring-1 ring-black/5 relative">
            <h1 class="text-sm md:text-base font-bold text-gray-400 uppercase tracking-widest mb-2">L·ªãch Ph·ª•ng V·ª• C√¥ng Gi√°o</h1>

            <div class="header-controls">
                <div class="calendar-zoom-controls">
                    <div class="calendar-zoom-group" role="group" aria-label="ƒêi·ªÅu ch·ªânh c·ª° ch·ªØ √¥ l·ªãch">
                        <button id="cellFontDec" class="calendar-zoom-btn" aria-label="Gi·∫£m c·ª° ch·ªØ">A-</button>
                        <button id="cellFontInc" class="calendar-zoom-btn" aria-label="TƒÉng c·ª° ch·ªØ">A+</button>
                    </div>
                </div>
                <button id="toggleTheme" class="theme-toggle" aria-pressed="false" aria-label="B·∫≠t giao di·ªán t·ªëi">
                    <i class="fas fa-moon"></i>
                    <span>Giao di·ªán t·ªëi</span>
                </button>
            </div>
            
            <div id="headerTodayInfo" class="mb-6 cursor-pointer group rounded-2xl p-6 transition-all hover:bg-gray-50" data-expanded="true">
                <!-- ===== EXPANDED VIEW (Khi ch∆∞a cu·ªôn) ===== -->
                <div id="headerExpanded" class="header-expanded">
                    <!-- Label "H√¥m nay" + M√†u ph·ª•ng v·ª• (·∫©n theo y√™u c·∫ßu) -->
                    <div class="today-chip hidden">
                        <span id="headerColorDot" class="w-4 h-4 rounded-full shadow-md ring-2 ring-white"></span>
                        <p class="text-sm md:text-base text-gray-500 font-bold uppercase tracking-widest">H√¥m nay</p>
                        <span id="headerRankBadge" class="hidden text-[0.7rem] font-bold uppercase px-3 py-1 rounded-full"></span>
                    </div>
                    
                    <div class="today-cycle-row">
                        <span id="headerCycle" class="today-cycle-text"></span>
                    </div>

                    <div class="today-date-wrap">
                        <button id="prevDayBtn" class="today-nav-btn" aria-label="H√¥m qua">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="headerDateCard" class="today-date-card">
                            <div id="headerDateText" class="today-date-text"></div>
                            <div id="headerLunarText" class="today-lunar-text"></div>
                        </div>
                        <button id="nextDayBtn" class="today-nav-btn" aria-label="Ng√†y mai">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>

                    <!-- 1. C·ª¨ H√ÄNH CH√çNH - N·ªïi b·∫≠t -->
                    <div id="headerCelebration" class="text-3xl md:text-5xl font-black text-gray-900 font-serif leading-tight mb-4 tracking-tight">Loading...</div>
                    
                    <!-- 2. Tu·∫ßn + Chu k·ª≥ (kh√¥ng c√≥ m√πa) -->
                    <div class="flex items-center justify-center gap-3 mb-4 flex-wrap">
                        <span id="headerSeasonWeek" class="text-base md:text-lg font-semibold text-gray-700"></span>
                    </div>
                    
                    <!-- 3. Tham chi·∫øu b√†i ƒë·ªçc -->
                    <div id="headerReadings" class="text-sm md:text-base text-gray-500 font-mono tracking-wide"></div>
                    
                    <!-- 4. Ghi ch√∫ k·ª∑ lu·∫≠t (ƒÉn chay, ki√™ng th·ªãt) -->
                    <div id="headerDiscipline" class="mt-4 hidden">
                        <div id="headerDisciplineContent" class="flex items-center justify-center gap-2 flex-wrap"></div>
                    </div>
                    
                    <!-- 5. C·ª≠ h√†nh ph·ª• (n·∫øu c√≥) - ·ªü d∆∞·ªõi c√πng -->
                    <div id="headerSecondary" class="mt-4 pt-4 border-t border-gray-200 hidden">
                        <p class="text-xs text-gray-400 uppercase tracking-wider mb-2">Kh√¥ng c·ª≠ h√†nh l·ªÖ</p>
                        <div id="headerSecondaryContent" class="text-sm md:text-base text-gray-600 font-medium"></div>
                    </div>
                    
                    <div class="text-xs text-blue-500 mt-4 opacity-0 group-hover:opacity-100 transition-opacity font-semibold uppercase tracking-wide">‚ü∂ Xem chi ti·∫øt b√†i ƒë·ªçc</div>
                </div>
                
                <!-- ===== COLLAPSED VIEW (Khi cu·ªôn xu·ªëng) ===== -->
                <div id="headerCollapsed" class="header-collapsed hidden">
                    <div class="compact-cycle-row">
                        <span id="headerCycleCompact" class="today-cycle-text today-cycle-text-compact"></span>
                    </div>
                    <div class="compact-nav-row">
                        <button id="prevDayBtnCompact" class="today-nav-btn today-nav-btn--compact" aria-label="H√¥m qua">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="compact-row">
                            <!-- M√†u ph·ª•ng v·ª• -->
                            <span id="headerColorDotCompact" class="w-3 h-3 rounded-full shadow-sm ring-1 ring-white flex-shrink-0"></span>
                            <!-- T√™n l·ªÖ -->
                            <span id="headerCelebrationCompact" class="text-lg md:text-xl font-bold text-gray-900 font-serif"></span>
                        </div>
                        <button id="nextDayBtnCompact" class="today-nav-btn today-nav-btn--compact" aria-label="Ng√†y mai">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <!-- B√†i ƒë·ªçc v·∫Øn t·∫Øt -->
                    <div id="headerReadingsCompact" class="text-xs text-gray-500 font-mono mt-2 text-center truncate"></div>
                    <!-- N√∫t m·ªü r·ªông -->
                    <button id="expandTodayBtn" class="mt-2 text-[10px] text-blue-500 hover:text-blue-700 font-semibold uppercase tracking-wider flex items-center justify-center gap-1 mx-auto transition-colors">
                        <i class="fas fa-chevron-down text-[8px]"></i> Xem th√™m
                    </button>
                </div>
            </div>

            <div class="flex items-center justify-center space-x-6 mt-4 pt-4 border-t border-gray-100">
                <button onclick="changeYear(-1)" class="year-nav-btn w-12 h-12 flex items-center justify-center bg-gray-100 rounded-full hover:bg-blue-100 hover:text-blue-600 transition text-lg"><i class="fas fa-chevron-left"></i></button>
                <span id="currentYearDisplay" class="text-4xl font-bold font-mono text-blue-700 tracking-tight">2024</span>
                <button onclick="changeYear(1)" class="year-nav-btn w-12 h-12 flex items-center justify-center bg-gray-100 rounded-full hover:bg-blue-100 hover:text-blue-600 transition text-lg"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="flex items-center justify-center gap-3 mt-3">
                <button onclick="goToToday()" class="text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline px-4 py-1 rounded-full hover:bg-blue-50 transition">V·ªÅ H√¥m Nay</button>
                <span class="text-gray-300">|</span>
                <button onclick="showExportOptions()" class="text-sm font-medium text-gray-500 hover:text-gray-700 px-4 py-1 rounded-full hover:bg-gray-100 transition flex items-center gap-2">
                    <i class="fas fa-download text-xs"></i> Xu·∫•t L·ªãch
                </button>
            </div>
        </header>
        
        <!-- Export Options Modal -->
        <div id="exportModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
                <div class="bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4 text-white">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-file-export"></i> Xu·∫•t L·ªãch Ph·ª•ng V·ª•
                    </h3>
                    <p class="text-sm text-blue-100 mt-1">Ch·ªçn ƒë·ªãnh d·∫°ng v√† ph·∫°m vi xu·∫•t</p>
                </div>
                
                <div class="p-6 space-y-5">
                    <!-- Ph·∫°m vi xu·∫•t -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Ph·∫°m vi xu·∫•t</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setExportRange('month')" id="exportRangeMonth" class="export-range-btn px-3 py-2 rounded-lg border-2 border-gray-200 text-sm font-medium hover:border-blue-400 transition">
                                Th√°ng n√†y
                            </button>
                            <button onclick="setExportRange('year')" id="exportRangeYear" class="export-range-btn active px-3 py-2 rounded-lg border-2 border-blue-500 bg-blue-50 text-blue-700 text-sm font-medium">
                                C·∫£ nƒÉm
                            </button>
                            <button onclick="setExportRange('custom')" id="exportRangeCustom" class="export-range-btn px-3 py-2 rounded-lg border-2 border-gray-200 text-sm font-medium hover:border-blue-400 transition">
                                Tu·ª≥ ch·ªçn
                            </button>
                        </div>
                        
                        <!-- Custom range inputs -->
                        <div id="customRangeInputs" class="hidden mt-3 grid grid-cols-2 gap-3">
                            <div>
                                <label class="text-xs text-gray-500">T·ª´ th√°ng</label>
                                <select id="exportFromMonth" class="w-full border rounded-lg px-3 py-2 text-sm mt-1">
                                    <option value="1">Th√°ng 1</option>
                                    <option value="2">Th√°ng 2</option>
                                    <option value="3">Th√°ng 3</option>
                                    <option value="4">Th√°ng 4</option>
                                    <option value="5">Th√°ng 5</option>
                                    <option value="6">Th√°ng 6</option>
                                    <option value="7">Th√°ng 7</option>
                                    <option value="8">Th√°ng 8</option>
                                    <option value="9">Th√°ng 9</option>
                                    <option value="10">Th√°ng 10</option>
                                    <option value="11">Th√°ng 11</option>
                                    <option value="12">Th√°ng 12</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-xs text-gray-500">ƒê·∫øn th√°ng</label>
                                <select id="exportToMonth" class="w-full border rounded-lg px-3 py-2 text-sm mt-1">
                                    <option value="1">Th√°ng 1</option>
                                    <option value="2">Th√°ng 2</option>
                                    <option value="3">Th√°ng 3</option>
                                    <option value="4">Th√°ng 4</option>
                                    <option value="5">Th√°ng 5</option>
                                    <option value="6">Th√°ng 6</option>
                                    <option value="7">Th√°ng 7</option>
                                    <option value="8">Th√°ng 8</option>
                                    <option value="9">Th√°ng 9</option>
                                    <option value="10">Th√°ng 10</option>
                                    <option value="11">Th√°ng 11</option>
                                    <option value="12" selected>Th√°ng 12</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- N·ªôi dung xu·∫•t -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">N·ªôi dung</label>
                        <div class="space-y-2">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="exportIncludeReadings" checked class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Bao g·ªìm tham chi·∫øu b√†i ƒë·ªçc</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="exportIncludeSaints" checked class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Bao g·ªìm l·ªãch c√°c th√°nh</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="exportIncludeLunar" checked class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Bao g·ªìm l·ªãch √¢m</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- ƒê·ªãnh d·∫°ng xu·∫•t -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ƒê·ªãnh d·∫°ng file</label>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="exportCalendar('json')" class="flex flex-col items-center gap-2 p-4 rounded-xl border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition group">
                                <i class="fas fa-file-code text-3xl text-gray-400 group-hover:text-blue-600"></i>
                                <span class="font-semibold text-gray-700 group-hover:text-blue-700">JSON</span>
                                <span class="text-xs text-gray-500">D·ªØ li·ªáu m√°y ƒë·ªçc</span>
                            </button>
                            <button onclick="exportCalendar('pdf')" class="flex flex-col items-center gap-2 p-4 rounded-xl border-2 border-gray-200 hover:border-red-500 hover:bg-red-50 transition group">
                                <i class="fas fa-file-pdf text-3xl text-gray-400 group-hover:text-red-600"></i>
                                <span class="font-semibold text-gray-700 group-hover:text-red-700">PDF</span>
                                <span class="text-xs text-gray-500">In ·∫•n / Chia s·∫ª</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="px-6 py-4 bg-gray-50 border-t flex justify-end">
                    <button onclick="closeExportModal()" class="px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded-lg transition">
                        ƒê√≥ng
                    </button>
                </div>
            </div>
        </div>

        <div id="calendarGrid" class="grid grid-cols-1 lg:grid-cols-2 gap-8"></div>
    </div>

    <!-- Detail Modal - Liturgical View -->
    <div id="dayModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50 px-4">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-60 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="modal-container bg-white w-full max-w-3xl mx-auto rounded-xl shadow-2xl z-50 overflow-hidden transform transition-all" id="modalContainer">
            
            <!-- Header v·ªõi m√†u ph·ª•ng v·ª• -->
            <div id="modalHeader" class="px-6 py-5 border-b relative">
                <div class="flex justify-between items-start">
                    <div class="flex-1">
                        <!-- Ng√†y th√°ng -->
                        <div class="flex items-center gap-3 flex-wrap mb-2">
                            <span class="text-sm uppercase font-bold text-gray-500" id="modalDayOfWeek">Ch√∫a Nh·∫≠t</span>
                            <span id="modalLunarDate" class="text-xs bg-red-50 text-red-700 px-2 py-0.5 rounded font-medium"></span>
                        </div>
                        <h3 class="text-2xl md:text-3xl font-bold serif-font text-gray-800 mb-3" id="modalDate">Ng√†y...</h3>
                        
                        <!-- 1. C·ª¨ H√ÄNH CH√çNH (title + rank + m√†u) -->
                        <div id="modalPrimaryCelebration" class="mb-3">
                            <div class="flex items-center gap-2 flex-wrap">
                                <span id="modalColorIndicator" class="w-4 h-4 rounded-full border-2 border-white shadow"></span>
                                <h4 id="modalCelebrationTitle" class="text-lg md:text-xl font-bold text-gray-900"></h4>
                                <span id="modalRankBadge" class="text-[0.65rem] font-bold uppercase px-2 py-0.5 rounded"></span>
                            </div>
                            <p id="modalCelebrationSubtitle" class="text-sm text-gray-600 mt-1 italic"></p>
                        </div>
                    </div>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 focus:outline-none bg-gray-100 hover:bg-gray-200 rounded-full p-2 transition-colors ml-4 flex-shrink-0">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>
                
                <!-- 2. M√ôA V√Ä TU·∫¶N + Chu k·ª≥ b√†i ƒë·ªçc -->
                <div id="modalSeasonWeek" class="flex flex-wrap items-center gap-2 mt-3 pt-3 border-t border-gray-200">
                    <span id="modalSeasonBadge" class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider"></span>
                    <span class="text-gray-300">|</span>
                    <span id="modalYearCycle" class="text-xs font-semibold text-blue-700 bg-blue-50 px-2 py-1 rounded">NƒÉm A</span>
                    <span id="modalObligationBadge" class="text-xs font-semibold text-blue-700 bg-blue-50 px-2 py-1 rounded hidden">L·ªÖ Bu·ªôc</span>
                    <span id="modalWeekdayCycle" class="text-xs font-semibold text-emerald-700 bg-emerald-50 px-2 py-1 rounded hidden">NƒÉm I</span>
                    <span id="modalCode" class="hidden text-xs font-mono text-gray-500 bg-gray-100 px-2 py-1 rounded ml-auto" title="M√£ Ng√†y Ph·ª•ng V·ª•">CODE</span>
                </div>
            </div>
            
            <!-- Body -->
            <div class="p-6 overflow-y-auto max-h-[70vh] bg-gray-50/50">
                
                <!-- 5. GHI CH√ö K·ª∂ LU·∫¨T PH·ª§NG V·ª§ (ƒÇn chay, ki√™ng th·ªãt, l·ªÖ bu·ªôc) -->
                <div id="modalDisciplineSection" class="mb-5 hidden">
                    <div id="modalDisciplineContent" class="flex flex-wrap gap-2"></div>
                </div>
                
                <!-- T·∫øt Section -->
                <div id="modalTetSection" class="mb-5 hidden bg-gradient-to-r from-red-50 to-orange-50 p-4 rounded-xl shadow-sm border border-red-200">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-2xl">üéä</span>
                        <h4 class="text-base font-bold text-red-700 uppercase">T·∫øt Nguy√™n ƒê√°n</h4>
                    </div>
                    <div id="modalTetContent" class="text-sm text-red-800"></div>
                </div>

                <!-- Ash Wednesday Transfer Note Section -->
                <div id="modalAshWednesdaySection" class="mb-5 hidden bg-gradient-to-r from-purple-50 to-violet-50 p-4 rounded-xl shadow-sm border border-purple-200">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-2xl">‚úùÔ∏è</span>
                        <h4 class="text-base font-bold text-purple-700 uppercase">L·ªÖ Tro - M√πa Chay</h4>
                    </div>
                    <div id="modalAshWednesdayContent" class="text-sm text-purple-800"></div>
                </div>

                <!-- 3. C√ÅC C·ª¨ H√ÄNH PH·ª§ (Saints, Commemorations) -->
                <div id="modalSecondaryCelebrations" class="mb-5 hidden">
                    <h4 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2">
                        <i class="fas fa-layer-group text-gray-400"></i> Kh√¥ng C·ª≠ H√†nh L·ªÖ
                    </h4>
                    <div id="modalSecondaryContent" class="space-y-2"></div>
                </div>

                <!-- Saints Section (chi ti·∫øt) -->
                <div id="modalSaintSection" class="mb-5 hidden bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                    <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                        <i class="fas fa-cross text-gray-300"></i> L·ªãch C√°c Th√°nh H√¥m Nay
                    </h4>
                    <div id="modalSaintContent" class="space-y-2"></div>
                </div>

                <!-- 4. B√ÄI ƒê·ªåC (Ref tr∆∞·ªõc, text sau) -->
                <div id="modalReadingSelectors" class="mb-5 bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                    <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                        <i class="fas fa-book-bible text-gray-300"></i> B√†i ƒê·ªçc Th√°nh L·ªÖ
                    </h4>
                    <!-- Reading source selector -->
                    <div id="modalReadingTabs" class="flex flex-wrap gap-2 mb-4"></div>
                    <!-- Reading references -->
                    <div id="modalReadingRefs" class="bg-gray-50 p-3 rounded-lg mb-4 hidden">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                            <div><span class="text-gray-500 text-xs block">B√†i ƒë·ªçc I</span><span id="refReading1" class="font-semibold text-gray-800"></span></div>
                            <div><span class="text-gray-500 text-xs block">ƒê√°p ca</span><span id="refPsalm" class="font-semibold text-gray-800"></span></div>
                            <div><span class="text-gray-500 text-xs block">B√†i ƒë·ªçc II</span><span id="refReading2" class="font-semibold text-gray-800"></span></div>
                            <div><span class="text-gray-500 text-xs block">Tin M·ª´ng</span><span id="refGospel" class="font-semibold text-gray-800"></span></div>
                        </div>
                    </div>
                </div>
                
                <!-- Readings Full Text Section -->
                <div id="modalReadingsSection" class="reading-section hidden bg-white p-5 rounded-xl shadow-sm border border-gray-100">
                    <div id="modalReadingsContent" class="space-y-6"></div>
                </div>

                <!-- No Reading Message -->
                <div id="noReadingMsg" class="hidden text-center py-10 text-gray-400">
                    <i class="fas fa-book text-4xl mb-3 opacity-30"></i>
                    <p class="italic">Ch∆∞a c√≥ d·ªØ li·ªáu b√†i ƒë·ªçc cho ng√†y n√†y.</p>
                </div>
                
                <!-- Eucharistic Adoration Section -->
                <div id="modalAdorationSection" class="hidden mt-5 bg-gradient-to-r from-amber-50 to-yellow-50 p-4 rounded-xl shadow-sm border border-amber-200">
                    <h4 class="text-xs font-bold text-amber-700 uppercase tracking-wider mb-2 flex items-center gap-2">
                        <i class="fas fa-church text-amber-500"></i> Ch·∫ßu Th√°nh Th·ªÉ
                    </h4>
                    <div id="modalAdorationContent" class="text-sm text-amber-900"></div>
                </div>

                <!-- Meditation Link Section -->
                <div id="modalMeditationSection" class="hidden mt-4 bg-gradient-to-r from-emerald-50 to-teal-50 p-4 rounded-xl shadow-sm border border-emerald-200">
                    <h4 class="text-xs font-bold text-emerald-700 uppercase tracking-wider mb-2 flex items-center gap-2">
                        <i class="fas fa-leaf text-emerald-600"></i> Suy Ni·ªám
                    </h4>
                    <a id="modalMeditationLink" class="text-sm font-semibold text-emerald-800 hover:text-emerald-900 underline underline-offset-4" target="_blank" rel="noopener noreferrer">
                        M·ªü suy ni·ªám h√¥m nay
                    </a>
                </div>
            </div>
        </div>
    </div>
<script src="Reading/readingdata.js"></script> 
<script src="Reading/readings_year_1.js"></script> 
<script src="Reading/readings_year_2.js"></script> 
<script src="Reading/Sunday.js"></script> 
<script src="Reading/DailySeason.js"></script> 
<script src="Reading/Saints.js"></script>
<script src="Reading/SaintsBible.js"></script>
<script src="Reading/Optionsaint.js"></script>
<script src="Reading/eucharisticAdoration.js"></script>
<script src="Reading/meditationLinks.js"></script>
<script src="js/controller.js"></script>

<!-- Service Worker Registration -->
    <script>
    // ƒêƒÉng k√Ω Service Worker ƒë·ªÉ cache t√†i nguy√™n
    // Ch·ªâ ƒëƒÉng k√Ω khi ch·∫°y tr√™n HTTP/HTTPS (kh√¥ng ph·∫£i file://)
    if ('serviceWorker' in navigator && (location.protocol === 'http:' || location.protocol === 'https:')) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./sw.js')
                .then((registration) => {
                    console.log('‚úÖ Service Worker ƒë√£ ƒëƒÉng k√Ω:', registration.scope);
                    
                    // Ki·ªÉm tra c·∫≠p nh·∫≠t
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        if (newWorker) {
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // C√≥ phi√™n b·∫£n m·ªõi
                                    console.log('üîÑ C√≥ phi√™n b·∫£n m·ªõi. L√†m m·ªõi trang ƒë·ªÉ c·∫≠p nh·∫≠t.');
                                }
                            });
                        }
                    });
                })
                .catch((error) => {
                    // Ch·ªâ log l·ªói n·∫øu kh√¥ng ph·∫£i l·ªói protocol (file://)
                    if (!error.message.includes('protocol') && !error.message.includes('null')) {
                        console.warn('‚ö†Ô∏è Service Worker kh√¥ng th·ªÉ ƒëƒÉng k√Ω:', error.message);
                    }
                });
        });
    } else if (location.protocol === 'file:') {
        // Ch·∫°y tr√™n file:// - Service Worker kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£, nh∆∞ng kh√¥ng c·∫ßn b√°o l·ªói
        console.log('‚ÑπÔ∏è Service Worker ch·ªâ ho·∫°t ƒë·ªông tr√™n HTTP/HTTPS. ƒêang ch·∫°y tr√™n file://');
    }
    </script>
</body>
</html>
